<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia at Sep 14, 2011 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title></title>
    <style type="text/css" media="all">
      @import url("./css/maven-base.css");
      @import url("./css/maven-theme.css");
      @import url("./css/site.css");
    </style>
    <link rel="stylesheet" href="./css/print.css" type="text/css" media="print" />
    <meta name="Date-Revision-yyyymmdd" content="20110914" />
    <meta http-equiv="Content-Language" content="en" />
                                                    
<link rel="stylesheet" type="text/css" href="/css/site%2ecss"/>
                      
        </head>
  <body class="composite">
    <div id="banner">
                                      <a href=".." id="bannerLeft">
                                                <img src="../images/softec.png" alt="SOFTEC sa" />
                </a>
                    <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
            
                
                <div class="xleft">
        <span id="publishDate">Last Published: 14 Sep 2011</span>
                  &nbsp;| <span id="projectVersion">Version: 1.1-softec</span>
                          |                           <a href="../index.html" title="JavaScript Maven Tools">JavaScript Maven Tools</a>
        &gt;
                              <a href="./" title="Javascript Maven Plugin">Javascript Maven Plugin</a>
        &gt;
    
              </div>
            <div class="xright">                    <a href="http://softec.lu/" class="externalLink" title="SOFTEC sa">SOFTEC sa</a>
              
                
      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
             
                
                                <h5>Overview</h5>
                  <ul>
                  <li class="none">
                          <a href="../index.html" title="Introduction">Introduction</a>
            </li>
                  <li class="none">
                          <a href="../javascript-maven-plugin/development.html" title="JavaScript development">JavaScript development</a>
            </li>
                  <li class="none">
                          <a href="../javascript-maven-plugin/webapp-development.html" title="JavaScript in Webapps">JavaScript in Webapps</a>
            </li>
                  <li class="none">
                          <a href="../javascript-maven-plugin/titanium-development.html" title="Titanium development">Titanium development</a>
            </li>
                  <li class="none">
                          <a href="../javascript-maven-plugin/titanium-tutorial.html" title="Titanium tutorial">Titanium tutorial</a>
            </li>
          </ul>
                       <h5>Parent Project</h5>
                  <ul>
                  <li class="none">
                          <a href="../index.html" title="Maven tools for JavaScript developers">Maven tools for JavaScript developers</a>
            </li>
          </ul>
                                 <h5>Project Documentation</h5>
                  <ul>
                                                                                                                                                                                                  <li class="collapsed">
                          <a href="project-info.html" title="Project Information">Project Information</a>
                  </li>
                                                                                                                                            <li class="collapsed">
                          <a href="project-reports.html" title="Project Reports">Project Reports</a>
                  </li>
          </ul>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="poweredBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                   
                
            </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <div class="section"><h2>Javascript development with Maven<a name="Javascript_development_with_Maven"></a></h2><div class="section"><h3>Why use Maven for JavaScript ?<a name="Why_use_Maven_for_JavaScript_"></a></h3><p>JavaScript is a ... script language. It does not require compilation neither packaging to be released. This doesn't mean developping a JavaScript library does not require some tooling.</p><p>JavaScript developers have created nice tools, like jsunit or jsdocs to get a productive and controlled development environment. They also use dedicated libraires like debug.js for development purpose, split code into fine grained scripts and use some assembly tools to create the released scripts like js-builder.</p><p>The Javascript Maven Plugin integrates those tools and provide a Maven packaging with a dedicated lifecycle.</p><div class="section"><h4>Folder structure<a name="Folder_structure"></a></h4><p>The Maven JavaScript Plugin use the following conventions for folder structure. This is only a standard layout, not a requirement, but will keep your POM files as simple as possible.</p><div class="source"><pre>  &lt;project-root&gt;/
  |
  +- pom.xml
  |
  +- src/
  |  |
  |  +- main/
  |  |  |
  |  |  +- javascript/ (source location for Scripts)
  |  |  +- resources/ (source location for any static resources)
  |  |
  |  +- test/
  |  |  |
  |  |  +- javascript/ (source location for (jsunit) test sources)
  |  |
  ...</pre></div></div><div class="section"><h4>Project Definition<a name="Project_Definition"></a></h4><p>Your project must configure some extentions to the maven base to enable the JavaScript support:</p><div class="source"><pre>&lt;project&gt;

  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
  &lt;groupId&gt;com.mycompany&lt;/groupId&gt;
  &lt;artifactId&gt;myexample&lt;/artifactId&gt;
  &lt;packaging&gt;javascript&lt;/packaging&gt;
  &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
  &lt;name&gt;My example Javascript project&lt;/name&gt;

  &lt;build&gt;
    &lt;outputDirectory&gt;target/scripts&lt;/outputDirectory&gt;
    &lt;testOutputDirectory&gt;target/test-scripts&lt;/testOutputDirectory&gt;
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.codehaus.mojo.javascript&lt;/groupId&gt;
        &lt;artifactId&gt;javascript-maven-plugin&lt;/artifactId&gt;
        &lt;extensions&gt;true&lt;/extensions&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;
&lt;/project&gt;</pre></div><p>Please note you have to setup Javascript Maven Plugin both:</p><p>- as a maven extension to get a JavaScript dedicated lifecycle</p><p>- as a plugin with <tt>&lt;extensions&gt;true&lt;/extensions&gt;</tt> to handle javascript dependencies</p><p>Once you have your pom setup then you can build the module in the normal way via:</p><div class="source"><pre>mvn install</pre></div></div><div class="section"><h4>Project life cycle<a name="Project_life_cycle"></a></h4><p>Maven will take your source scripts and assemble them following an optional descriptor. The descriptor can either be written via the plugin native XML format, or using a <a class="externalLink" href="http://code.google.com/p/js-builder">jsbuilder</a> file. All non listed scripts will simply be copied to the packaging directory.</p><p>A typical assembler looks like this :</p><div class="source"><pre>&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;assembler&gt;
  &lt;scripts&gt;
    &lt;script&gt;
      &lt;fileName&gt;prototype.js&lt;/fileName&gt;
      &lt;includes&gt;
        &lt;include&gt;builder.js&lt;/include&gt;
        &lt;include&gt;controls.js&lt;/include&gt;
        &lt;include&gt;dragdrop.js&lt;/include&gt;
        &lt;include&gt;effects.js&lt;/include&gt;
        &lt;include&gt;global.js&lt;/include&gt;
        &lt;include&gt;slider.js&lt;/include&gt;
      &lt;/includes&gt;
    &lt;/script&gt;
  &lt;/scripts&gt;
&lt;/assembler&gt;</pre></div><p>The <tt>src/assembler</tt> folder will contain this assembler descriptor. By default, the <tt>compile</tt> goal will search for an assembler descriptor whose name match the one of the artifact id.</p><p>You can take advantage of other javascript librairies to make your code simplier or cleaner. Simply declare a dependency of type <tt>javascript</tt> and Maven will download the associated javascript archive.</p><div class="source"><pre>  &lt;dependencies&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.prototypejs&lt;/groupId&gt;
      &lt;artifactId&gt;prototype&lt;/artifactId&gt;
      &lt;version&gt;1.5.1.1&lt;/version&gt;
      &lt;type&gt;javascript&lt;/type&gt;
    &lt;/dependency&gt;
  &lt;/dependencies&gt;</pre></div><p>You can unit test your scripts by including <a class="externalLink" href="http://www.jsunit.net">jsUnit</a> tests. Tests, source scripts and dependencies will be copied in a working directory before running the test suite.</p></div><div class="section"><h4>Strip debuging code<a name="Strip_debuging_code"></a></h4><p>Coding JavaScript is difficult due to the lack of compiler to check the code, and few debuggers availables. Many developers use debuging code, for example based on the <a class="externalLink" href="https://github.com/softec/debug">debug.js</a> library.</p><p>In some case a production-mode is considered and disables debugs. For example, the log4JavaScript library comes with a stub version that does nothing. The JavaScript Maven Plugin offers an alternative solution with the <tt>compress</tt> goal. This goal, appart for providing JS compression to your code, could also removes all lines from the packaged scripts that start with one or more special tokens. To remove debug.js, type and argument checking code from the following sample :</p><div class="source"><pre>    var format = function( n, format )
    {
      Improved.checkType(Object.isNumber,n,this);
      Improved.checkType(Object.isString,format,this);
      debug.debug( &quot;format &quot; + n + &quot; as &quot; + format );
      /*debug*/ if( isNaN(n) ) return &quot;-&quot;;
      ....</pre></div><p>you simply configure the <tt>compress</tt> goal using:</p><div class="source"><pre> &lt;plugin&gt;
    &lt;groupId&gt;org.codehaus.mojo.javascript&lt;/groupId&gt;
    &lt;artifactId&gt;javascript-maven-plugin&lt;/artifactId&gt;
    &lt;configuration&gt;
      ...
      &lt;strips&gt;
          &lt;strip&gt;debug.&lt;/strip&gt;
          &lt;strip&gt;Improved.check&lt;/strip&gt;
          &lt;strip&gt;/*debug*/&lt;/strip&gt;
      &lt;/strips&gt;
      ...
    &lt;/configuration&gt;
...</pre></div></div><div class="section"><h4>Compress the scripts<a name="Compress_the_scripts"></a></h4><p>The compress goal is also usefull to compress scripts for production, minimizing load time and bandwidth consumption for the end-user.</p><p>The compressor used is configurable and currently support <a class="externalLink" href="http://www.crockford.com/JavaScript/jsmin.html">JsMin</a>, <a class="externalLink" href="http://dojotoolkit.org/docs/shrinksafe">Dojo Shrinksafe</a> and <a class="externalLink" href="http://developer.yahoo.com/yui/compressor/">YUI Compressor</a>.</p><p>The compress-attached goal is for pure JavaScript developers purpose. It creates a second artifact for the JavaScript library with compressed scripts.</p><p>Here is a profile to attach a compressed release version of a JavaScript library, without debugging code and compressed using YUI compressor at level 5 :</p><div class="source"><pre>      &lt;profiles&gt;
        &lt;profile&gt;
          &lt;id&gt;release&lt;/id&gt;
          &lt;build&gt;
            &lt;plugins&gt;
              &lt;plugin&gt;
                &lt;groupId&gt;org.codehaus.mojo.javascript&lt;/groupId&gt;
                &lt;artifactId&gt;javascript-maven-plugin&lt;/artifactId&gt;
                &lt;configuration&gt;
                  &lt;compressor&gt;yahooUI&lt;/compressor&gt;
                  &lt;optimizationLevel&gt;5&lt;/optimizationLevel&gt;
                  &lt;strips&gt;
                      &lt;strip&gt;debug.&lt;/strip&gt;
                      &lt;strip&gt;Improved.check&lt;/strip&gt;
                      &lt;strip&gt;/*debug*/&lt;/strip&gt;
                  &lt;/strips&gt;
                &lt;/configuration&gt;
                &lt;executions&gt;
                  &lt;execution&gt;
                    &lt;id&gt;compress&lt;/id&gt;
                    &lt;phase&gt;compile&lt;/phase&gt;
                    &lt;goals&gt;
                      &lt;goal&gt;compress&lt;/goal&gt;
                    &lt;/goals&gt;
                  &lt;/execution&gt;
                  &lt;execution&gt;
                    &lt;id&gt;package-compressed&lt;/id&gt;
                    &lt;phase&gt;package&lt;/phase&gt;
                    &lt;goals&gt;
                      &lt;goal&gt;attach-compressed&lt;/goal&gt;
                    &lt;/goals&gt;
                  &lt;/execution&gt;
                &lt;/executions&gt;
              &lt;/plugin&gt;
            &lt;/plugins&gt;
          &lt;/build&gt;
        &lt;/profile&gt;
      &lt;/profiles&gt;</pre></div></div><div class="section"><h4>Deployment<a name="Deployment"></a></h4><p>Finally, Maven will package your scripts as a JavaScript archive to get deployed in your Maven repository. Optionally, you can create a compressed version of your scripts, to distribute a lightweight version of your project to non-maven users.</p></div><div class="section"><h4>Project documentation<a name="Project_documentation"></a></h4><p>You can document your code by following the <a class="externalLink" href="http://www.jsdoctoolkit.org">jsDoc</a> conventions, very similar to javadoc.</p><p>Maven can also run <a class="externalLink" href="http://www.jslint.com">jslint</a> on your project to check code quality.</p></div></div></div>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
              Copyright &#169;                    2011
                        <a href="http://softec.lu/">SOFTEC sa</a>.
            All Rights Reserved.      
                
                  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
